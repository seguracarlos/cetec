<script type="text/javascript">
var basePath = "<?php echo $this->basePath(); ?>";
var id_shipingAdd = "<?php echo $this->journey['id_journey']; ?>";
function showaddgas(){
	if( $('#addGas').is(":visible") ){
	    $('#addGas').fadeOut(500);
	}else{
		$(".closeExpensesTable").fadeOut(300);
	    $('#addGas').fadeIn("slow");
	}
}
function showaddcas(){
	if( $('#addCas').is(":visible") ){
	    $('#addCas').fadeOut(500);
	}else{
		$(".closeExpensesTable").fadeOut(300);
	    $('#addCas').fadeIn("slow");
	}
}
function showaddfood(){
	if( $('#addFood').is(":visible") ){
	    $('#addFood').fadeOut(500);
	}else{
		$(".closeExpensesTable").fadeOut(300);
	    $('#addFood').fadeIn("slow");
	}
}
function showaddVarios(){
	if( $('#addVarios').is(":visible") ){
	    $('#addVarios').fadeOut(500);
	}else{
		$(".closeExpensesTable").fadeOut(300);
	    $('#addVarios').fadeIn("slow");
	}
}
</script>
<div class="breadcrumbs">
	<div class="container">
		<div class="col-md-4"><div class="row"><p class="title-breadcrumbs">Gastos por viaje</p></div></div>
		<div class="col-md-4">
			<div class="row">
				<ul class="toolbar">
					<li><a href="#" class="btn"> <span class="glyphicon glyphicon-home"></span> Uno </a></li>
					<li><a href="#" class="btn"> <span class="glyphicon glyphicon-home"></span> Dos </a></li>
					<li><a href="#" class="btn"> <span class="glyphicon glyphicon-home"></span> Tres </a></li>
				</ul>
			</div>
		</div>
		<div class="col-md-4">
			<div style="line-height: 38px" class="row text-right">
				<div class="btn-group btn-breadcrumb">
			    	<a href="#" class="btn btn-default"><i class="glyphicon glyphicon-home"></i></a>
			        <a href="#" class="btn btn-default">Egresos</a>
			        <a href="#" class="btn btn-default">Gastos por viaje</a>
			        <a href="#" class="btn btn-default">Agregar</a>
				</div>
			</div>
		</div>
    </div> <!-- end container -->
</div> <!-- end breadcrumbs -->
<div class="container">
	<div class="content-forms">
		<?php if($this->journey){?>
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-12">
				<div class="panel panel-info">
  					<div class="panel-heading">
  						<div class="row">
  							<div class="col-xs-12 col-sm-6 col- col-md-6">
  								Gastos por viajes for&aacute;neos<br>
  								Folio-Cliente: <?php echo $this->journey['client_folio']; ?>
  							</div>
  							<div class="col-xs-12 col-sm-3 col-md-3"></div>
  							<div class="col-xs-12 col-sm-3 col-md-3">
  									<a href="<?php echo $this->basePath('/out/expenses-trip/jurneyending'); ?>"><button class="btn btn-success">Volver al historial</button></a>
  							</div>
  						</div>
  					</div>
  				</div>
  			</div>
			<div class="col-xs-12 col-sm-4 col-md-4">
				<div class="panel panel-primary">
  					<ul class="list-group">
  						<li class="list-group-item">Operador: <?php echo $this->journey['operador']['name']." ".$this->journey['operador']['surname']." ".$this->journey['operador']['lastname']; ?></li>
  						<li class="list-group-item">Ayudante(s): <?php foreach($this->journey['ayudantes'] as $ayudante): echo "<br>".$ayudante['name']." ".$ayudante['surname']." ".$ayudante['lastname']; endforeach;?></li>
  						<li class="list-group-item">Cliente: <?php echo $this->journey['cliente']; ?></li>
  						<li class="list-group-item">Unidad: <?php  echo $this->journey['unidad']; ?></li>
  						<li class="list-group-item">Destino(s): <?php echo $this->journey['destino']; ?></li>
  						<?php if($this->journey['sinister'] == null){ ?>
  						<li id="redimientoViaje" class="list-group-item">Rendimiento: <?php echo ($this->journey['end_mileage']-$this->journey['starting_mileage'])/(($this->expensesAll['totalGas']+$this->journey['end_gasoline_end_journey'])/14.20); ?></li>
  						<?php }else{ ?>
  						<li class="list-group-item">Imposible calcular el rendimiento<br>(Viaje que termino en Siniestro)</li>
  						<?php } ?>
  					</ul>
				</div>
			</div>
			<div class="col-xs-12 col-sm-4 col-md-4">
				<div class="panel panel-primary"> 
  					<ul class="list-group">
  						<li class="list-group-item">Depositos: <label id="countDepositos"><?php echo count($this->expensesAll['viaticos']); ?></label></li>
  						<li class="list-group-item">
  							<div class="row">
  								<div class="col-xs-2 col-sm-2 col-md-2">
  									Viaticos:
  								</div>
  								<div class="col-xs-7 col-sm-7 col-md-7" id="viaticList">
  									<?php if(count($this->expensesAll['viaticos']) > 0){
  										$listViaticos = $this->expensesAll['viaticos']; 
  										for($j = 0; $j < count($listViaticos);$j++){
  											if($j > 0){
  												echo ",";
  											}
  											echo " $".$listViaticos[$j]['amount_expensestrip'];
  										}
  									}?>
  								</div>
  							</div>
  						</li>
  						<li class="list-group-item">
  							<div class="row">
  								<div class="col-xs-4 col-sm-4 col-md-4">
  									Total de viaticos:
  								</div>
  								<div class="col-xs-7 col-sm-7 col-md-7 input-group">
  									<div class="input-group-addon">$</div>
  									<input type="text" class="form-control" placeholder="Total de viaticos" id="viaticSum" value="<?php echo $this->expensesAll['totalViat']; ?>" disabled />
  								</div>
  							</div> 
  						</li>
  						<li class="list-group-item">Total de gastos: $<label id="totalExpensesFinal"><?php echo $totalExpenses = $this->expensesAll['totalGas']+$this->expensesAll['totalCas']+$this->expensesAll['totalAlim']+$this->expensesAll['totalVar']; ?></label></li>
  						<li class="list-group-item">Diferencia entre viaticos y gastos: $<label id="difViatExp"><?php echo  $res = $this->expensesAll['totalViat']-($this->expensesAll['totalGas']+$this->expensesAll['totalCas']+$this->expensesAll['totalAlim']+$this->expensesAll['totalVar']);?></label>
  						</li>
  					</ul>
				</div>
			</div>
			<div class="col-xs-12 col-sm-4 col-md-4">
				<div class="panel panel-primary">
  					<ul class="list-group">
  						<li class="list-group-item">Fecha inicial: <?php echo $this->journey['fecha']; ?></li>
  						<li class="list-group-item">Kilometraje inicial: <?php echo $this->journey['starting_mileage']; ?></li>
  						<li class="list-group-item" id="divEndKm">
  							Kilometraje Final: <?php echo $this->journey['end_mileage']; ?>
  						</li>
  						<li class="list-group-item" id="divInitialGasoline">
  							Gasolina Inicial: <?php echo $this->journey['start_gasoline']; ?>
  						</li>
  						<li class="list-group-item" id="divFinalGasoline">
  							Gasolina Final: <?php echo $this->journey['end_gasoline']; ?>
  						</li>
  						<li class="list-group-item" id="divFinalGasolineEndJourney">
  								Carga final de gasolina: <label id="labelFinalGasolineEndJourney"><?php echo $this->journey['end_gasoline_end_journey']; ?></label>
  						</li>
  					</ul>
				</div>
			</div>
		</div>
		
		<br>
		
		<div class="row">
		
			<div class="col-xs-12 col-sm-12 col-md-12">
				<button style="width: 100%" type="button" onclick="showaddgas()" class="btn btn-primary">Gastos de Gasolina</button>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 closeExpensesTable" style="display:none;background: #F5FFFA;" id="addGas">
				<br>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="col-xs-6 col-sm-2 col-md-2"><label>Total de gastos en gasolina:</label></div><div class="col-xs-5 col-sm-4 col-md-4 input-group"><div class="input-group-addon">$</div><input class="form-control" type="text" id="totalGas" name="totalGas" value="<?php echo $this->expensesAll['totalGas']; ?>" disabled="true"/></div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover table-condensed" id="tableAddGas">
							<tr class="info">
								<th>#</th>
								<th>Folio Factura</th>
								<th>Total</th>
							</tr>
							<?php if($this->expensesAll['gasolina']){
								foreach($this->expensesAll['gasolina'] as $gasolinaExpenses): 
							?>
							<tr id="tableDateExpense<?php echo $gasolinaExpenses['id_expensestrip']; ?>">
								<td>1</td>
								<td><?php echo $gasolinaExpenses['reference_expensestrip']; ?></td>
								<td><?php echo $gasolinaExpenses['amount_expensestrip']; ?></td>
							</tr>
							<?php
								endforeach; 
								}else{ 
							?>
							<tr>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<?php }
							?>
						</table>
					</div>				
				</div>
			</div>
			
			<div class="col-xs-12 col-sm-12 col-md-12">
				<button style="width: 100%" type="button" onclick="showaddcas()" class="btn btn-success">Gastos de Casetas</button>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 closeExpensesTable" style="display:none;background: #F5FFFA;" id="addCas">
				<br>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="col-xs-6 col-sm-2 col-md-2"><label>Total de gastos en casetas:</label></div><div class="col-xs-5 col-sm-4 col-md-4 input-group"><div class="input-group-addon">$</div><input class="form-control" type="text" id="totalCas" name="totalCas" value="<?php echo $this->expensesAll['totalCas']; ?>" disabled="true"/></div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover table-condensed" id="tableAddCas">
							<tr class="success">
								<th>#</th>
								<th>Fol.Tiket</th>
								<th>Total</th>
							</tr>
							<?php if($this->expensesAll['casetas']){
									foreach($this->expensesAll['casetas'] as $casetaExpenses): 
							?>
							<tr id="tableDateExpense<?php echo $casetaExpenses['id_expensestrip']; ?>">
								<td>1</td>
								<td><?php echo $casetaExpenses['reference_expensestrip']; ?></td>
								<td><?php echo $casetaExpenses['amount_expensestrip']; ?></td>
							</tr>
							<?php
								endforeach; 
								}else{ 
							?>
							<tr>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<?php }
							?>
						</table>
					</div>				
				</div>
			</div>
			
			<div class="col-xs-12 col-sm-12 col-md-12">
				<button style="width: 100%" onclick="showaddfood()" type="button" class="btn btn-info">Gastos de Alimentos</button>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 closeExpensesTable" style="display:none;background: #F5FFFA;" id="addFood">
				<br>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="col-xs-6 col-sm-2 col-md-2"><label>Total de gastos en alimentos:</label></div><div class="col-xs-5 col-sm-4 col-md-4 input-group"><div class="input-group-addon">$</div><input class="form-control" type="text" id="totalAlim" name="totalAlim" value="<?php echo $this->expensesAll['totalAlim']; ?>" disabled="true"/></div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover table-condensed" id="tableAddFood">
							<tr class="info">
								<th>#</th>
								<th>Descripci&oacute;n</th>
								<th>Fol.Factura</th>
								<th>Total</th>
							</tr>
							<?php if($this->expensesAll['alimentos']){
								foreach($this->expensesAll['alimentos'] as $alimentosExpenses): 
							?>
							<tr id="tableDateExpense<?php echo $alimentosExpenses['id_expensestrip']; ?>">
								<td>1</td>
								<td><?php echo $alimentosExpenses['description_expensestrip']; ?></td>
								<td><?php echo $alimentosExpenses['reference_expensestrip']; ?></td>
								<td><?php echo $alimentosExpenses['amount_expensestrip']; ?></td>
							</tr>
							<?php
								endforeach; 
								}else{ 
							?>
							<tr>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<?php }
							?>
						</table>
					</div>				
				</div>
			</div>
			
			<div class="col-xs-12 col-sm-12 col-md-12">
				<button style="width: 100%" onclick="showaddVarios()" type="button" class="btn btn-warning">Varios</button>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 closeExpensesTable"  style="display:none;background: #F5FFFA;" id="addVarios">
				<br>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="col-xs-6 col-sm-2 col-md-2"><label>Total de gastos variados:</label></div><div class="col-xs-5 col-sm-4 col-md-4 input-group"><div class="input-group-addon">$</div><input class="form-control" type="text" id="totalVar" name="totalVar" value="<?php echo $this->expensesAll['totalVar']; ?>" disabled="true"/></div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover table-condensed" id="tableAddVarios">
							<tr class="warning">
								<th>#</th>
								<th>Descripci&oacute;n</th>
								<th>Fol.Factura</th>
								<th>Total</th>
							</tr>
							<?php if($this->expensesAll['varios']){
								foreach($this->expensesAll['varios'] as $variosExpenses): 
							?>
							<tr id="tableDateExpense<?php echo $variosExpenses['id_expensestrip']; ?>">
								<td>1</td>
								<td><?php echo $variosExpenses['description_expensestrip']; ?></td>
								<td><?php echo $variosExpenses['reference_expensestrip']; ?></td>
								<td><?php echo $variosExpenses['amount_expensestrip']; ?></td>
							</tr>
							<?php
								endforeach; 
								}else{ 
							?>
							<tr>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<?php }
							?>
						</table>
					</div>				
				</div>
			</div>
		</div>
		<?php }else{ ?>
		<div class="row">
			<h1>Porfavor seleccione un viaje.</h1>
		</div>
		<?php }?>
	</div>	
</div>